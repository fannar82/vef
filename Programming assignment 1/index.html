<!DOCTYPE html>
<!-- (c) Fannar Már Sigurðsson & Finnbjörn Þorvaldsson -->
<!-- Háskólinn í Reykjavík -->
<!-- WEPO, vor 2013-->
<!-- Programming assignment 1 -->
<html>
<head>
<script type="text/javascript" src="Base.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>

</head>
<body>

<p>Starts here</p>
<div id="colorPicker">
	<span id="black">Black</span>
	<span id="blue">Blue</span>
	<span id="red">Red</span>
	<span id="green">Green</span>
</div>
<div id="toolPicker">
	<span id="rectangle">Rectangle</span>
	<span id="circle">Circle</span>
	<span id="freehand">Freehand</span>
	<span id="line">Line</span>
</div>

<canvas id="drawing-board" width="800px" height="800px">
	<p>
		Your browser does not support this. Please update your browser and enter 2013.
	</p>
</canvas>

<p>Ends here</p>

<script type="text/javascript">
	console.log("Main loading.");
	var currentShape;
	var canvas = document.getElementById("drawing-board");
	var context = canvas.getContext("2d");
	var tool = "rectangle";
	var color = "red";
	var shapesArray = new Array();
	var mouseIsDown = false;
	
	$(canvas).mousedown( function(e) {
		// Set starting point (different shapes might
		// treat "starting point" differently)
		// StartX,Y fixes browser compability
		startX = e.pageX - this.offsetLeft;
		startY = e.pageY - this.offsetTop;

		// Select shape to draw
		if ( tool == "rectangle" ){
			currentShape = new Rectangle(startX, startY);
		}
		if ( tool == "circle" ){
			currentShape = new Circle(startX, startY);
		}
		if ( tool == "freehand" ){
			currentShape = new Freehand( startX, startY );
		}
		if ( tool == "line" ){
			currentShape = new Line( startX, startY );
		}

		// The mouse has been pressed
		mouseIsDown = true;
	});

	$(canvas).mousemove( function(e) {
		if ( mouseIsDown == true ){
			if( tool == "freehand" ) {
				currentShape.setEnd( e.pageX, e.pageY );
				currentShape.draw();
	  		}
	  	}
	});
	
	$(canvas).mouseup( function(e) {
		currentShape.setEnd( e.pageX, e.pageY );
		currentShape.draw();

		// Push the shape to the array for later usage
		shapesArray.push(currentShape);
		console.log( "A shape was added to shapesArray, current count: " + shapesArray.length );
		console.log( "List of all shapes: " + shapesArray.toString() );

		// The mouse is no longer pressed
		mouseIsDown = false;
	});

	console.log("Main loaded.");
</script>

<script type="text/javascript" src="color.js"></script>
<script type="text/javascript" src="shape.js"></script>
<script type="text/javascript" src="circle.js"></script>
<script type="text/javascript" src="rect.js"></script>
<script type="text/javascript" src="freehand.js"></script>
<script type="text/javascript" src="line.js"></script>
</body>
</html>